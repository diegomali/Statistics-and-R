set.seed(1) #so that we get same results
n <- 1000
averages5 <- vector("numeric",n)
for(i in 1:n){
X <- sample(x,5)
averages5[i] <- mean(X)
}
hist(averages5) ##take a look
head(x)
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
library(downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/femaleControlsPopulation.csv"
filename <- basename(url)
download(url, destfile=filename)
x <- unlist( read.csv(filename) )
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
for(i in 1:n){
avgPopulations <- sample(x,5)
avgs[i] <- mean(avgPopulations)
}
hist(avgs)
abs( (avgs > mean(x)) > 1 )
mean(abs( (avgs > mean(x)) > 1 ))
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
for(i in 1:n){
avgPopulations <- sample(x,5)
avgs[i] <- mean(avgPopulations)
}
hist(avgs)
mean((avgs - mean(x)) > 1 ))
mean((avgs - mean(x) > 1 ))
mean((abs(avgs - mean(x)) > 1 ))
avgs < mean(x)
avgs - mean(x)
abs(avgs - mean(x))
abs(avgs - mean(x)) > 1
mean(abs(avgs - mean(x)) > 1)
avgX <- mean(x)
mean(abs(avgs - avgX) > 1)
set.seed(1)
n <- 10000
set.seed(1)
n <- 10000
avgs <- vector("numeric",n)
for(i in 1:n){
avgPopulations <- sample(x,5)
avgs[i] <- mean(avgPopulations)
}
hist(avgs)
avgX <- mean(x)
mean(abs(avgs - avgX) > 1)
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
for(i in 1:n){
avgPopulations <- sample(x, 50)
avgs[i] <- mean(avgPopulations)
}
hist(avgs)
avgX <- mean(x)
mean(abs(avgs - avgX) > 1)
install.packages("gapminder")
library(gapminder)
data(gapminder)
head(gapminder)
library(dplyr)
library(dplyr)
library(gapminder)
library(dplyr)
filter(gapminder, year=1952)
filter(gapminder, year==1952)
filter(gapminder, year==1952) %>% group_by(country)
filter(gapminder, year==1952) %>% group_by(country)
filter(gapminder, year==1952) %>% group_by(country=true)
filter(gapminder, year==1952) %>% group_by(gapminder$country)
filter(gapminder, year==1952) %>% group_by(country)
filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp)
filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
filter(gapminder, year==1952)
filter(gapminder, year==1952) %>% group_by(country)
filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp)
filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
library(gapminder)
library(dplyr)
data(gapminder)
head(gapminder)
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
x
mean(x <= 40)
library(gapminder)
#
mean(x <= 60) - mean(x <= 40)
mean(x <= 60) - mean(x >= 40)
mean(x <= 60)
mean(x <= 40)
mean(x <= 60) - mean(x <= 40)
mean(x <= 60)
mean(x <= 40)
0.5880282 - 0.2852113
mean(x <= 60) - mean(x <= 40)
mean(x <= 60) - mean(x <= 40)
mean(x <= 60) - mean(x >= 40)
abs(mean(x <= 60) - mean(x >= 40))
mean(x <= 60) - mean(x <= 40)
mean( (x <= 60) - (x <= 40))
mean(x <= 60) - mean(x <= 40)
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
mean(x <= 60) - mean(x <= 40)
mean(x<=60) - mean(x<=40)
dat1952 = gapminder[ gapminder$year == 1952, ]
x = dat1952$lifeExp
mean(x<=60) - mean(x<=40)
x <- filter(gapminder, year==1952) %>%  select(lifeExp) %>% unlist
mean(x<=60) - mean(x<=40)
hist(x)
hist(filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp))
hist(filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist)
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
mean(x <= 40)
x <- filter(gapminder, year==1952) %>% group_by(country) %>% select(lifeExp) %>% unlist
mean(x<=60) - mean(x<=40)
abs(mean(x<=60) - mean(x<=40))
mean(abs(x<=60) - mean(x<=40))
x <- filter(gapminder, year==1952) %>% select(lifeExp) %>% unlist
mean(x <= 40)
mean(x<=60) - mean(x<=40)
hist(x)
plot(filter(gapminder, year==1952) %>% select(lifeExp))
x <- filter(gapminder, year==1952) %>% select(lifeExp) %>% unlist
hist(x)
mean(x <= 40)
mean(x<=60) - mean(x<=40)
plot(ecdf(x))
prop = function(q) {
mean(x <= q)
}
prop(40)
prop(60)
qs = seq(from=min(x), to=max(x), length=20)
qs
props = sapply(qs, prop)
props = sapply(qs, prop)
plot(qs, props)
prop
props
plot(qs, props)
plot(qs, props)
props = sapply(qs, function(q) mean(x <= q))
qs
plot(qs, props)
plot(ecdf(x))
props
?plot
library(downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/femaleControlsPopulation.csv"
filename <- basename(url)
download(url, destfile=filename)
x <- unlist( read.csv(filename) )
n <- 1000
set.seed(1)
avgM1 <- vector('numeric', n)
for (i in 1:n) {
avgM1[i] <- sample(x, 5)
}
avgM1
avgM50 <- vector('numeric', n)
avgM50 <- vector('numeric', n)
set.seed(1)
for (i in 1:n) {
avgM1[i] <- sample(x, 50)
}
hist(mean(avgM1))
n <- 1000
set.seed(1)
avgM1 <- vector('numeric', n)
for (i in 1:n) {
avgM1[i] <- sample(x, 5)
}
hist(mean(avgM1))
hist(mean(avgM1))
avgM1
hist(avgM1)
hist(avgM50)
avgM50 <- vector('numeric', n)
set.seed(1)
for (i in 1:n) {
avgM1[i] <- sample(x, 50)
}
set.seed(1)
avgM1 <- vector('numeric', n)
for (i in 1:n) {
avgM1[i] <- sample(x, 5)
}
avgM50 <- vector('numeric', n)
set.seed(1)
for (i in 1:n) {
avgM50[i] <- sample(x, 50)
}
hist(avgM1)
hist(avgM50)
hist(avgM1)
n <- 1000
set.seed(1)
avgM1 <- vector('numeric', n)
for (i in 1:n) {
avgM1[i] <- mean(sample(x, 5))
}
hist(avgM1)
avgM50 <- vector('numeric', n)
set.seed(1)
for (i in 1:n) {
avgM50[i] <- mean(sample(x, 50))
}
hist(avgM50)
hist(avgM1)
hist(avgM50)
hist(avgM1)
hist(avgM50)
avgX <- mean(x)
mean(abs(avgs - avgX))
mean(abs(avgM50 - avgX))
mean(avgM50 <=25) - mean(avgM50 <=23)
mean( averages50 < 25 & averages50 > 23.9)
mean( avgM50 < 25 & avgM50 > 23.9)
mean( (avgM50 < 25 & avgM50 > 23.9) >= 0.43)
mean( (avgM50 > 23.9) >= 0.43)
mean( (avgM50 > 23.9) >= 0.43)
?sd
pnorm(avgM50, 23.9, 0.43)
?pnorm
normalDistribution <- pnorm(avgM50, 23.9, 0.43)
mean( normalDistribution < 25 & normalDistribution > 23)
normalDistribution <- pnorm(avgM50, 23.9, 0.43)
mean( normalDistribution < 25 & normalDistribution > 23)
normalDistribution <- pnorm(avgM50, 23.9, 0.43)
normalDistribution
normalDistribution <- pnorm(x, 23.9, 0.43)
normalDistribution
mean( normalDistribution < 25 & normalDistribution > 23)
avgM50
mean( normalDistribution < 25 & normalDistribution > 23)
normalDistribution < 25 & normalDistribution > 23
mean(pnorm(avgM50, 23.9, 0.43))
normalDistribution <- pnorm(avgM50, 23.9, 0.43)
normalDistribution <- pnorm(avgM50, 23.9, 0.43)
set.seed(1)
normalDistributionAVG <- vector('numeric', n)
normalDistribution <- pnorm(avgM50, 23.9, 0.43)
set.seed(1)
normalDistributionAVG <- vector('numeric', n)
for (i in 1:n) {
normalDistributionAVG[i] <- mean(sample(normalDistribution, 50))
}
mean(normalDistributionAVG <=25) - mean(normalDistributionAVG <=23)
mean(normalDistributionAVG <=25) - mean(normalDistributionAVG <=23)
mean(abs(normalDistributionAVG <=25) - mean(normalDistributionAVG <=23)
mean(abs(normalDistributionAVG <=25) - mean(normalDistributionAVG <=23)_
mean(abs(normalDistributionAVG <=25) - mean(normalDistributionAVG <=23))
mean(abs(normalDistributionAVG <=25) - mean(normalDistributionAVG >=23))
pnorm( (25-23.9) / 0.43)  - pnorm( (23-23.9) / 0.43)
cat('\014')
library(downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/mice_pheno.csv"
filename <- basename(url)
download(url, destfile=filename)
dat <- read.csv(filename)
dat <- read.csv(filename)
dat <- na.omit( dat )
dat
library(dplyr)
controlMales <- filter(dat, Sex=="M") %>% filter(Diet=="chow")  %>% select(Bodyweight) %>% unlist
controlMales
mean(controlMales)
installed.packages("rafalib")
install_github("ririzarr/rafalib")
library(devtools)
install_github("ririzarr/rafalib")
?popsd
popsd
popsd(controlMales)
popsd(controlMales)
library(rafalib)
popsd(controlMales)
mean(sample(controlMales, 25))
set.seed(1)
mean(sample(dat, 25))
population <- unlist(dat)
mean(sample(population, 25))
set.seed(1)
mean(sample(population, 25))
set.seed(1)
mean(sample(population, 25))
population <- filter(Diet=="chow")  %>% select(Bodyweight) %>% unlist(dat)
set.seed(1)
mean(sample(population, 25))
set.seed(1)
mean(sample(controlMales, 25))
set.seed(1)
mean(sample(controlMales, 25))
set.seed(1)
mean(sample(controlMales, 25))
controlMalesHF <- filter(dat, Sex=="M") %>% filter(Diet=="hf")  %>% select(Bodyweight) %>% unlist
mean(controlMalesHF)
popsd(controlMalesHF)
set.seed(1)
mean(sample(controlMalesHF, 25))
set.seed(1)
mean(sample(controlMalesHF, 25))
set.seed(1)
YOb <-  mean(sample(controlMalesHF, 25))
set.seed(1)
XOb <-  mean(sample(controlMales, 25))
x <-mean(controlMales)
y <- mean(controlMalesHF)
(y - x) - (YOb - XOb)
x <- mean(filter(dat, Sex=="M" & Diet=="chow") %>% select(Bodyweight) %>% unlist)
y <- mean(filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist)
controlFemales <- mean(filter(dat, Sex=="M" & Diet=="chow") %>% select(Bodyweight) %>% unlist)
controlFemalesHF <- mean(filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
(y - x) - (YOb - XOb)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
(y - x) - (YOb - XOb)
abs((y - x) - (YOb - XOb))
controlFemales <- mean(filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist)
controlFemalesHF <- mean(filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
abs((y - x) - (YOb - XOb))
controlFemales <- mean(filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist)
controlFemalesHF <- mean(filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
x <- mean(controlFemales)
y <- mean(controlFemalesHF)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
abs((y - x) - (YOb - XOb))
controlFemales <- mean(filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist)
controlFemalesHF <- mean(filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist)
x <- mean(controlFemales)
y <- mean(controlFemalesHF)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
abs((y - x) - (YOb - XOb))
controlFemales <- mean(filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist)
controlFemalesHF <- mean(filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist)
x <- mean(controlFemales)
y <- mean(controlFemalesHF)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
abs((y - x) - (YOb - XOb))
controlFemales <- filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist
controlFemales <- filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist
controlFemalesHF <- filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist
x <- mean(controlFemales)
y <- mean(controlFemalesHF)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
abs((y - x) - (YOb - XOb))
set.seed(1)
sum(sample(controlFemales, 25))
set.seed(1)
#579.23 * (1/25)
579.23 * (1/25)
set.seed(1)
sum(sample(controlFemales, 25)) / 25
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
XOb
library(downloader)
library(downloader)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/mice_pheno.csv"
filename <- basename(url)
download(url, destfile=filename)
dat <- na.omit( read.csv(filename) )
dat <- na.omit( read.csv(filename) )
?pnorm
dat
library(dplyr)
population <- select(Bodyweight) %>% unlist
population <- select(dat, Bodyweight) %>% unlist
obs <- mean(population)
obs
library(rafalib)
obs <- mean(population)
popsd(population)
obs <- mean(population)
pnorm(obs,mean(null),sd(null))
popsd(population)
sdP <-  popsd(population)
mean( (obs - sdP) > 1)
obs <- mean(population)
sdP <-  popsd(population)
mean( (obs - sdP) > 1)
obs <- mean(population)
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
avgs <- vector("numeric",n)
for(i in 1:n){
avgPopulations <- sample(dat,5)
avgs[i] <- mean(avgPopulations)
}
obs <- mean(population)
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
obs <- mean(population)
set.seed(1)
n <- 1000
avgs <- vector("numeric",n)
for(i in 1:n){
avgPopulations <- sample(population,5)
avgs[i] <- mean(avgPopulations)
}
?pnorm
pnorm(avgs, obs, 1)
?sd
sd(population)
?pnorm(avgs, obs, 1)
pnorm(population, mean(avgs), (sd(population) + 1))
pnorm(obs, mean(avgs), (sd(population) + 1))
obsDiff <- mean(avgs) - obs
obsDiff
pnorm(obsDiff, mean(avgs), (sd(population) + 1))
obsDiff <- abs(mean(avgs) - obs)
pnorm(obsDiff, mean(avgs), (sd(population) + 1))
controlFemales <- filter(dat, Sex=="F" & Diet=="chow") %>% select(Bodyweight) %>% unlist
controlFemalesHF <- filter(dat, Sex=="F" & Diet=="hf") %>% select(Bodyweight) %>% unlist
x <- mean(controlFemales)
y <- mean(controlFemalesHF)
set.seed(1)
XOb <-  mean(sample(controlFemales, 25))
set.seed(1)
YOb <-  mean(sample(controlFemalesHF, 25))
abs((y - x) - (YOb - XOb))
pnorm(1)-pnorm(-1)
pnorm(2)-pnorm(-2)
?pnorm
pnorm(3)-pnorm(-3)
pnorm(3)-pnorm(-3)
library(rafalib)
sdPopulation <- popsd(dat)
sdPopulation <- popsd(dat)
sdPopulation <- popsd(dat)
y <- filter(dat, Sex=="M") %>% filter(Diet=="hf")  %>% select(Bodyweight) %>% unlist
sdPopulation <- popsd(y)
y
sdPopulation
y <- filter(dat, Sex=="M") %>% filter(Diet=="chow")  %>% select(Bodyweight) %>% unlist
sdPopulation <- popsd(y)
sdPopulation
x <- filter(dat, Sex=="M") %>% filter(Diet=="hf")  %>% select(Bodyweight) %>% unlist
pnorm( (y / sdPopulation)  - pnorm( (x / sdPopulation))
pnorm( (y / sdPopulation))  - pnorm( (x / sdPopulation))
pnorm( (y / sdPopulation))  - pnorm( (x / sdPopulation))
pnorm( (y / sdPopulation))  - pnorm( (x / sdPopulation))
pnorm( (y / sdPopulation))  - pnorm( (x / sdPopulation))
pnorm( ( mean(y) / sdPopulation))  - pnorm( (mean(x) / sdPopulation))
pnorm( 1/ sdPopulation)  - pnorm(-1/ sdPopulation)
pnorm(1, y, sdPopulation)  - pnorm(-1, y, sdPopulation)
pnorm(1, mean(y), sdPopulation)  - pnorm(-1, mean(y), sdPopulation)
pnorm(1, NULL, sdPopulation)  - pnorm(-1, NULL, sdPopulation)
y <- filter(dat, Sex=="M") %>% filter(Diet=="chow")  %>% select(Bodyweight) %>% unlist
pnorm(1, NULL, sdPopulation)  - pnorm(-1, NULL, sdPopulation)
z <- (y - mean(y)) / popsd(y)
mean(abs(z)<=1)
z
z
mean(abs(z)<=2)
mean(abs(z)<=3)
y <- filter(dat, Sex=="M" & Diet=="chow") %>% select(Bodyweight) %>% unlist
avgs <- replicate(10000, mean( sample(y, 25)))
mypar(1,2)
hist(avgs)
qqnorm(avgs)
qqline(avgs)
mean(avgs)
popsd(avgs)
